{"version":3,"file":"HelpImpl.js","sourceRoot":"","sources":["../../../../../front_end/help/HelpImpl.js"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2017 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../common/common.js';  // eslint-disable-line no-unused-vars\nimport * as Host from '../host/host.js';\nimport * as UI from '../ui/ui.js';  // eslint-disable-line no-unused-vars\n\nimport {releaseNoteText} from './ReleaseNoteText.js';\n\nexport const releaseVersionSeen = 'releaseNoteVersionSeen';\n\n/**\n * @const\n * @type {string}\n */\nexport const releaseNoteViewId = 'release-note';\n\n/**\n * @type {!ReleaseNote}\n */\nlet _latestReleaseNote;\n\n/**\n * @return {!ReleaseNote}\n */\nexport function latestReleaseNote() {\n  /**\n   * @type {!Array<!ReleaseNote>}\n   */\n  // @ts-ignore Included only for layout tests.\n  const globalReleaseNotes = self.Help.releaseNoteText;\n  if (!_latestReleaseNote) {\n    _latestReleaseNote =\n        (globalReleaseNotes || releaseNoteText).reduce((acc, note) => note.version > acc.version ? note : acc);\n  }\n  return _latestReleaseNote;\n}\n\nexport function showReleaseNoteIfNeeded() {\n  const releaseNoteVersionSetting = Common.Settings.Settings.instance().createSetting(releaseVersionSeen, 0);\n  const releaseNoteVersionSettingValue = releaseNoteVersionSetting.get();\n  innerShowReleaseNoteIfNeeded(\n      releaseNoteVersionSettingValue, latestReleaseNote().version,\n      Common.Settings.Settings.instance().moduleSetting('help.show-release-note').get());\n}\n\n/**\n * @param {number} lastSeenVersion\n * @param {number} latestVersion\n * @param {boolean} showReleaseNote\n *\n */\nexport function innerShowReleaseNoteIfNeeded(lastSeenVersion, latestVersion, showReleaseNote) {\n  const releaseNoteVersionSetting = Common.Settings.Settings.instance().createSetting(releaseVersionSeen, 0);\n  if (!lastSeenVersion) {\n    releaseNoteVersionSetting.set(latestVersion);\n    return;\n  }\n  if (!showReleaseNote) {\n    return;\n  }\n  if (lastSeenVersion >= latestVersion) {\n    return;\n  }\n  releaseNoteVersionSetting.set(latestVersion);\n  UI.ViewManager.ViewManager.instance().showView(releaseNoteViewId, true);\n}\n\n/**\n * @implements {Common.Runnable.Runnable}\n */\nexport class HelpLateInitialization {\n  /**\n   * @override\n   */\n  async run() {\n    if (!Host.InspectorFrontendHost.isUnderTest()) {\n      showReleaseNoteIfNeeded();\n    }\n  }\n}\n\n/**\n * @implements {UI.ActionRegistration.ActionDelegate}\n */\nexport class ReleaseNotesActionDelegate {\n  /**\n   * @override\n   * @param {!UI.Context.Context} context\n   * @param {string} actionId\n   * @return {boolean}\n   */\n  handleAction(context, actionId) {\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(latestReleaseNote().link);\n    return true;\n  }\n}\n\n/**\n * @implements {UI.ActionRegistration.ActionDelegate}\n */\nexport class ReportIssueActionDelegate {\n  /**\n   * @override\n   * @param {!UI.Context.Context} context\n   * @param {string} actionId\n   * @return {boolean}\n   */\n  handleAction(context, actionId) {\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(\n        'https://bugs.chromium.org/p/chromium/issues/entry?template=DevTools+issue');\n    return true;\n  }\n}\n\n/** @typedef {!{title: string, subtitle: string, link: string}} */\n// @ts-ignore typedef\nexport let ReleaseNoteHighlight;\n\n/**\n * @typedef {!{version: number, header: string, highlights: !Array<!ReleaseNoteHighlight>,\n *    link: string}}\n */\n// @ts-ignore typedef\nexport let ReleaseNote;\n"]}