"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = require("fs");
const path = require("path");
let cachedConfig;
/*
  Only reads disk once.
  Throws error if non-existent / unreadable each time it's requested.
*/
exports.default = () => {
    if (cachedConfig) {
        return cachedConfig;
    }
    const configPath = path.join(process.resourcesPath, "todesktop-runtime-config.json");
    if (!(0, fs_1.existsSync)(configPath)) {
        throw new Error(`ToDesktop runtime config doesn't exist (${configPath})`);
    }
    try {
        cachedConfig = JSON.parse((0, fs_1.readFileSync)(configPath, { encoding: "utf-8" }));
        return cachedConfig;
    }
    catch (e) {
        throw new Error(`Cannot read ToDesktop runtime config (${configPath})`);
    }
};
